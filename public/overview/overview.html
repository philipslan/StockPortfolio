<!DOCTYPE html>
<html lang="en" ng-app="portfolio">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Stock Portfolio</title>

  <!-- CSS Files -->
  <link href="index/bootstrap.min.css" rel='stylesheet' type='text/css'>
  <link href="index/style.css" rel='stylesheet' type='text/css'>
  <link href="index/jumbotron-narrow.css" rel='stylesheet' type='text/css'>

  <!-- Javascript Files -->
  <script src="/js/jquery.js"></script>
  <script src="/js/bootstrap.min.js"></script>

  <!-- Angular -->
  <script src="/js/angular.min.js"></script>
  <script src="/js/angular-cookies.js"></script>
  <script src='/js/module.js'></script>

  <!-- Angular Components -->
  <script src="/index/mainController.js"></script>
  <script src="/overview/overviewController.js"></script>

</head>
<body ng-controller="overviewController">
  <div class="container">
    <div class="header clearfix">
      <nav>
        <ul class="nav navbar-nav navbar-right">
          <li class="welcome"><h5>Welcome, {{user}}!</h5></li>
          <li><button class="btn btn-success" ng-click="logout()">Logout</button></li>
        </ul>

      </nav>
      <h4 class="text-muted"><a href="/">Portfolio Manager Home</a></h4>
    </div>
    
    <div class="container">
      <div class='row' ng-if="portfolios.length">

        <div class="col-md-3">
          <br><br>
            <ul id="pillTabs" class="nav nav-pills nav-stacked" role="tablist">
                <li ng-class="{active: view=='overview'}">
                  <a ng-click="view='overview'" class='clickable' role="tab">Overview</a>
                </li>
                <li>
                  <a href="performance.html" role="tab"class='clickable'>Performance</a>
                </li>
                <li ng-class="{active: view=='transaction'}">
                  <a ng-click="view='transaction'" class='clickable' role="tab">Transaction</a>
                </li>
                <li><a href="strategy.html" role="tab">Strategy</a></li>
            </ul>
        </div>

        <div class="col-md-9">
            <ul id="myTabs"class="nav nav-tabs" role="tablist">
              <li ng-repeat="portfolio in portfolios" 
                ng-class="{active: {{$index}} == 0}">
                <a href="#portfolio{{$index}}" role="tab" data-toggle="tab" ng-click="act($index)">{{portfolio[1]}}</a>
              </li>
              <li role="presentation">
                <a data-toggle="modal" data-target="#portfolio" role="tab" data-toggle="tab" class="clickable">Add Portfolio</a>
              </li>
            </ul>

            <div class="tab-content folder" ng-repeat="portfolio in portfolios" ng-if="index == $index">
              <div role="tabpanel" class="tab-pane active" id="#portfolio{{$index}}">

                <div role='tabpanel' class='tab-pane' id='overview' ng-if="view=='overview'">
                  <h5>Cash Balance: {{portfolio[2] | currency}}</h5>
                  <h5>Holdings:</h5>
                  <table class="table table-hover" ng-repeat="holding in holdings" ng-if="holdings.length">
                    <tr>
                      <th>#</th>
                      <th>Name</th>
                      <th>Symbol</th>
                      <th>Present Value</th>
                      <th>Shares</th>
                    </tr>
                    <tr class='clickable' data-href='stock.html'>
                      <td>1</td>
                      <td>Apple</td>
                      <td>AAPL</td>
                      <td>94.95</td>
                      <td>100</td>
                    </tr>
                  </table>
                  <h5 ng-if="!holdings.length">No current Holdings. Go to transaction to purchase holding.</h5>
                  <br>
                </div>

                <div role='tabpanel' class='tab-pane' id='transaction' ng-if="view=='transaction'">
                  <h5>Cash Balance: {{portfolio[2] | currency}}</h5>
                  <h4>Buy</h4>
                  <form class="form-inline">
                    <div class="form-group">
                      <input type="text" class="form-control" id="buySymbol" placeholder="Symbol">
                    </div>
                    <div class="form-group">
                      <input type="text" class="form-control" id="buyAmount" placeholder="Amount">
                    </div>
                    <button type="submit" class="btn btn-default">Submit</button>
                  </form>

                  <h4>Sell</h4>
                  <form class="form-inline">
                    <div class="form-group">
                      <input type="text" class="form-control" id="sellSymbol" placeholder="Symbol">
                    </div>
                    <div class="form-group">
                      <input type="text" class="form-control" id="sellAmount" placeholder="Amount">
                    </div>
                    <button type="submit" class="btn btn-default">Submit</button>
                  </form>

                  <h4>Cash</h4>
                  <form class="form-inline">
                    <div class="form-group">
                      <div class="input-group">
                        <div class="input-group-addon">$</div>
                        <input type="number" ng-model="cash_update" class="form-control" id="cashAmount" placeholder="Amount" min="0.01" step="0.01">
                      </div>
                    </div>
                    <button type="submit" class="btn btn-primary" ng-click="deposit(portfolio[0],cash_update)">Deposit</button>
                    <button type="submit" class="btn btn-primary" ng-click="withdraw(portfolio[0],cash_update)">Withdraw</button>
                  </form>
                </div>
              </div>
            </div>

        </div>
      </div>
      <div class="row" ng-if="!portfolios.length">
        <a data-toggle="modal" data-target="#portfolio" class="clickable">Create a new Portfolio</a>
        <br/>
        <a href="/">Home</a>
      </div>
    </div>
    <!-- Create New Portfolio -->
    <div class="modal fade" id="portfolio" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="exampleModalLabel">Create Portfolio</h4>
          </div>
          <form>
            <div class="modal-body">
              <div class="form-group">
                <label class="control-label">Name:</label>
                <input type="text" class="form-control" ng-model="pname">
              </div>
              <div class="form-group">
                <label class="control-label">Cash Amount:</label>
                <input type="number" min="0.01" step="0.01" class="form-control" ng-model="p_cash_amnt">
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
              <button type="submit" class="btn btn-success" ng-click="create_new(pname,p_cash_amnt)">Create</button>
            </div>
          </form>
        </div>
      </div>
    </div>
    <footer class="footer">
      <p>&copy;Philip Lan, Tina Shin</p>
    </footer>
  </div> <!-- /container -->
</body>
</html>
